using System;
using System.Data;
using System.Web.UI;
using System.Configuration;
using BusinessLogicLayer;

namespace ERP.OMS.Reports
{
    public partial class Reports_frm_attendance_PD_report : System.Web.UI.Page
    {
        BusinessLogicLayer.DBEngine oDBEngine = new BusinessLogicLayer.DBEngine(ConfigurationSettings.AppSettings["DBConnectionDefault"]);
        protected void Page_Load(object sender, EventArgs e)
        {

        }
        protected void btnShow_Click(object sender, EventArgs e)
        {
            if (txtID.Text != "")
            {
                DataTable DT = oDBEngine.GetDataTable("((SELECT (case when ATD_STATUSDAY1='CL' then 1 else 0 end) +(case when ATD_STATUSDAY2='CL' then 1 else 0 end) +(case when ATD_STATUSDAY3='CL' then 1 else 0 end) +(case when ATD_STATUSDAY4='CL' then 1 else 0 end) +(case when ATD_STATUSDAY5='CL' then 1 else 0 end) +(case when ATD_STATUSDAY6='CL' then 1 else 0 end) +(case when ATD_STATUSDAY7='CL' then 1 else 0 end) +(case when ATD_STATUSDAY8='CL' then 1 else 0 end) +(case when ATD_STATUSDAY9='CL' then 1 else 0 end) +(case when ATD_STATUSDAY10='CL' then 1 else 0 end) +(case when ATD_STATUSDAY11='CL' then 1 else 0 end) +(case when ATD_STATUSDAY12='CL' then 1 else 0 end) +(case when ATD_STATUSDAY13='CL' then 1 else 0 end) +(case when ATD_STATUSDAY14='CL' then 1 else 0 end) +(case when ATD_STATUSDAY15='CL' then 1 else 0 end) +(case when ATD_STATUSDAY16='CL' then 1 else 0 end) +(case when ATD_STATUSDAY17='CL' then 1 else 0 end) +(case when ATD_STATUSDAY18='CL' then 1 else 0 end) +(case when ATD_STATUSDAY19='CL' then 1 else 0 end) +(case when ATD_STATUSDAY20='CL' then 1 else 0 end) +(case when ATD_STATUSDAY21='CL' then 1 else 0 end) +(case when ATD_STATUSDAY22='CL' then 1 else 0 end) +(case when ATD_STATUSDAY23='CL' then 1 else 0 end) +(case when ATD_STATUSDAY24='CL' then 1 else 0 end) +(case when ATD_STATUSDAY25='CL' then 1 else 0 end) +(case when ATD_STATUSDAY26='CL' then 1 else 0 end) +(case when ATD_STATUSDAY27='CL' then 1 else 0 end) +(case when ATD_STATUSDAY28='CL' then 1 else 0 end) +(case when ATD_STATUSDAY29='CL' then 1 else 0 end) +(case when ATD_STATUSDAY30='CL' then 1 else 0 end) +(case when ATD_STATUSDAY31='CL' then 1 else 0 end) as CL,(case when ATD_STATUSDAY1='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY2='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY3='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY4='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY5='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY6='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY7='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY8='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY9='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY10='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY11='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY12='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY13='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY14='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY15='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY16='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY17='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY18='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY19='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY20='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY21='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY22='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY23='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY24='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY25='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY26='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY27='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY28='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY29='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY30='Pd' then 1 else 0 end) +(case when ATD_STATUSDAY31='Pd' then 1 else 0 end) as PD,(case when ATD_STATUSDAY1='PL' then 1 else 0 end) +(case when ATD_STATUSDAY2='PL' then 1 else 0 end) +(case when ATD_STATUSDAY3='PL' then 1 else 0 end) +(case when ATD_STATUSDAY4='PL' then 1 else 0 end) +(case when ATD_STATUSDAY5='PL' then 1 else 0 end) +(case when ATD_STATUSDAY6='PL' then 1 else 0 end) +(case when ATD_STATUSDAY7='PL' then 1 else 0 end) +(case when ATD_STATUSDAY8='PL' then 1 else 0 end) +(case when ATD_STATUSDAY9='PL' then 1 else 0 end) +(case when ATD_STATUSDAY10='PL' then 1 else 0 end) +(case when ATD_STATUSDAY11='PL' then 1 else 0 end) +(case when ATD_STATUSDAY12='PL' then 1 else 0 end) +(case when ATD_STATUSDAY13='PL' then 1 else 0 end) +(case when ATD_STATUSDAY14='PL' then 1 else 0 end) +(case when ATD_STATUSDAY15='PL' then 1 else 0 end) +(case when ATD_STATUSDAY16='PL' then 1 else 0 end) +(case when ATD_STATUSDAY17='PL' then 1 else 0 end) +(case when ATD_STATUSDAY18='PL' then 1 else 0 end) +(case when ATD_STATUSDAY19='PL' then 1 else 0 end) +(case when ATD_STATUSDAY20='PL' then 1 else 0 end) +(case when ATD_STATUSDAY21='PL' then 1 else 0 end) +(case when ATD_STATUSDAY22='PL' then 1 else 0 end) +(case when ATD_STATUSDAY23='PL' then 1 else 0 end) +(case when ATD_STATUSDAY24='PL' then 1 else 0 end) +(case when ATD_STATUSDAY25='PL' then 1 else 0 end) +(case when ATD_STATUSDAY26='PL' then 1 else 0 end) +(case when ATD_STATUSDAY27='PL' then 1 else 0 end) +(case when ATD_STATUSDAY28='PL' then 1 else 0 end) +(case when ATD_STATUSDAY29='PL' then 1 else 0 end) +(case when ATD_STATUSDAY30='PL' then 1 else 0 end) +(case when ATD_STATUSDAY31='PL' then 1 else 0 end) as PL,(case when ATD_STATUSDAY1='SL' then 1 else 0 end) +(case when ATD_STATUSDAY2='SL' then 1 else 0 end) +(case when ATD_STATUSDAY3='SL' then 1 else 0 end) +(case when ATD_STATUSDAY4='SL' then 1 else 0 end) +(case when ATD_STATUSDAY5='SL' then 1 else 0 end) +(case when ATD_STATUSDAY6='SL' then 1 else 0 end) +(case when ATD_STATUSDAY7='SL' then 1 else 0 end) +(case when ATD_STATUSDAY8='SL' then 1 else 0 end) +(case when ATD_STATUSDAY9='SL' then 1 else 0 end) +(case when ATD_STATUSDAY10='SL' then 1 else 0 end) +(case when ATD_STATUSDAY11='SL' then 1 else 0 end) +(case when ATD_STATUSDAY12='SL' then 1 else 0 end) +(case when ATD_STATUSDAY13='SL' then 1 else 0 end) +(case when ATD_STATUSDAY14='SL' then 1 else 0 end) +(case when ATD_STATUSDAY15='SL' then 1 else 0 end) +(case when ATD_STATUSDAY16='SL' then 1 else 0 end) +(case when ATD_STATUSDAY17='SL' then 1 else 0 end) +(case when ATD_STATUSDAY18='SL' then 1 else 0 end) +(case when ATD_STATUSDAY19='SL' then 1 else 0 end) +(case when ATD_STATUSDAY20='SL' then 1 else 0 end) +(case when ATD_STATUSDAY21='SL' then 1 else 0 end) +(case when ATD_STATUSDAY22='SL' then 1 else 0 end) +(case when ATD_STATUSDAY23='SL' then 1 else 0 end) +(case when ATD_STATUSDAY24='SL' then 1 else 0 end) +(case when ATD_STATUSDAY25='SL' then 1 else 0 end) +(case when ATD_STATUSDAY26='SL' then 1 else 0 end) +(case when ATD_STATUSDAY27='SL' then 1 else 0 end) +(case when ATD_STATUSDAY28='SL' then 1 else 0 end) +(case when ATD_STATUSDAY29='SL' then 1 else 0 end) +(case when ATD_STATUSDAY30='SL' then 1 else 0 end) +(case when ATD_STATUSDAY31='SL' then 1 else 0 end) as SL,(case when ATD_STATUSDAY1='HC' then 1 else 0 end) +(case when ATD_STATUSDAY2='HC' then 1 else 0 end) +(case when ATD_STATUSDAY3='HC' then 1 else 0 end) +(case when ATD_STATUSDAY4='HC' then 1 else 0 end) +(case when ATD_STATUSDAY5='HC' then 1 else 0 end) +(case when ATD_STATUSDAY6='HC' then 1 else 0 end) +(case when ATD_STATUSDAY7='HC' then 1 else 0 end) +(case when ATD_STATUSDAY8='HC' then 1 else 0 end) +(case when ATD_STATUSDAY9='HC' then 1 else 0 end) +(case when ATD_STATUSDAY10='HC' then 1 else 0 end) +(case when ATD_STATUSDAY11='HC' then 1 else 0 end) +(case when ATD_STATUSDAY12='HC' then 1 else 0 end) +(case when ATD_STATUSDAY13='HC' then 1 else 0 end) +(case when ATD_STATUSDAY14='HC' then 1 else 0 end) +(case when ATD_STATUSDAY15='HC' then 1 else 0 end) +(case when ATD_STATUSDAY16='HC' then 1 else 0 end) +(case when ATD_STATUSDAY17='HC' then 1 else 0 end) +(case when ATD_STATUSDAY18='HC' then 1 else 0 end) +(case when ATD_STATUSDAY19='HC' then 1 else 0 end) +(case when ATD_STATUSDAY20='HC' then 1 else 0 end) +(case when ATD_STATUSDAY21='HC' then 1 else 0 end) +(case when ATD_STATUSDAY22='HC' then 1 else 0 end) +(case when ATD_STATUSDAY23='HC' then 1 else 0 end) +(case when ATD_STATUSDAY24='HC' then 1 else 0 end) +(case when ATD_STATUSDAY25='HC' then 1 else 0 end) +(case when ATD_STATUSDAY26='HC' then 1 else 0 end) +(case when ATD_STATUSDAY27='HC' then 1 else 0 end) +(case when ATD_STATUSDAY28='HC' then 1 else 0 end) +(case when ATD_STATUSDAY29='HC' then 1 else 0 end) +(case when ATD_STATUSDAY30='HC' then 1 else 0 end) +(case when ATD_STATUSDAY31='HC' then 1 else 0 end) as HC,case atd_month when 1 then 'Jan' when 2 then 'Feb' when 3 then 'Mar' when 4 then 'Apr' when 5 then 'May' when 6 then 'Jun' when 7 then 'Jul' when 8 then 'Aug' when 9 then 'Sep' when 10 then 'Oct' when 11 then 'Nov' when 12 then 'Dec' else 'N/A' end as AttdMonth,atd_month FROM TBL_TRANS_ATTENDANCE WHERE ATD_CNTID in(select cnt_internalID from tbl_master_contact where cnt_shortName='" + txtID.Text + "')  and atd_year=2009)) as D order by cast(atd_month as int)", " * ", null);
                grdReport.DataSource = DT.DefaultView;
                grdReport.DataBind();
                Page.ClientScript.RegisterStartupScript(GetType(), "PageLoad", "<script>height();</script>");
            }
        }
    }

}