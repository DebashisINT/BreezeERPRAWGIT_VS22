using System;
using System.Data;
using System.Web;
using System.Web.UI;
using DevExpress.Web;
using System.Configuration;
using BusinessLogicLayer;

namespace ERP.OMS.Reports
{
    public partial class Reports_frm_ReportAssetDetail_iframe : System.Web.UI.Page
    {

        BusinessLogicLayer.DBEngine oDBEngine = new BusinessLogicLayer.DBEngine();
        BusinessLogicLayer.Converter objConverter = new BusinessLogicLayer.Converter();

        DataTable dtblItems = null;
        DataTable dtblLocation = null;
        DataTable dtblUser = null;
        DataTable dtblSubAsset = null;
        string Scompany = "";
        string FinYear = "";
        string SpanText1 = "";
        protected void Page_Init(object sender, EventArgs e)
        {
            DatasourceAssetSub.ConnectionString = Convert.ToString(System.Web.HttpContext.Current.Session["ErpConnection"]);
            DatasourceAssetMain.ConnectionString = Convert.ToString(System.Web.HttpContext.Current.Session["ErpConnection"]);
            DatasourceFinancialYear.ConnectionString = Convert.ToString(System.Web.HttpContext.Current.Session["ErpConnection"]);
            AssetDetailDatasource.ConnectionString = Convert.ToString(System.Web.HttpContext.Current.Session["ErpConnection"]);
            DataSourceDetailAssetGrid.ConnectionString = Convert.ToString(System.Web.HttpContext.Current.Session["ErpConnection"]);
           
        }
        protected void Page_Load(object sender, EventArgs e)
        {

            if (rdnAll.Checked == true)
            {
                txtAssetMain.Text = "ALL";
                txtAssetSub.Text = "ALL";
            }

            if (HttpContext.Current.Session["LastCompany"].ToString() != "" && HttpContext.Current.Session["LastFinYear"].ToString() != "")
            {
                Scompany = HttpContext.Current.Session["LastCompany"].ToString();
                FinYear = HttpContext.Current.Session["LastFinYear"].ToString();


            }

            txtLocation.Attributes.Add("onkeyup", "CallList(this,'LocationName',event)");

            txtUsedBy.Attributes.Add("onkeyup", "CallList(this,'UsedBy',event)");

            txtAssetMain.Attributes.Add("onkeyup", "CallList(this,'AssetMain',event)");

            txtAssetSub.Attributes.Add("onkeyup", "CallList(this,'AssetSub',event)");


            if (!IsPostBack)
            {

                ScriptManager.RegisterStartupScript(this, this.GetType(), "JSct", "ForFilter();", true);
                ScriptManager.RegisterStartupScript(this, this.GetType(), "JSct", "ForCkeckBox();", true);

                //BindGrid();
            }

        }
        protected void BindGrid()
        {
            AssetDetailDatasource.SelectCommand = "select MainAccount_Name as MainAccountName,isnull(SUM(AssetDetail_Disposals),0.00)as Disposals,isnull(SUM(AssetDetail_Depreciation),0.00) As Depreciation,isnull(SUM(Additions),0.00) As Additions,isnull(Sum(AccountsLedger_AmountDr),0.00)As OpeningBalance,isnull(SUM(AssetDetail_CostPrice),0.00) as CostPrice,(isnull(SUM(AccountsLedger_AmountDr),0.00)+isnull(SUM(Additions),0.00)-isnull(SUM(AssetDetail_Disposals),0.00)-isnull(SUM(AssetDetail_Depreciation),0.00)) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' Group By MainAccount_Name";
            AssetDetailGrid.DataBind();

        }
        protected void txtAssetSub_SelectedIndexChanged(object sender, EventArgs e)
        {

        }
        protected void txtAssetSub_Callback(object source, DevExpress.Web.CallbackEventArgsBase e)
        {
            FillSubAsset(e.Parameter);

        }
        protected void FillSubAsset(string MainAsset)
        {
            // internal
            //if (string.IsNullOrEmpty(MainAsset)) return;
            //DatasourceAssetSub.SelectParameters[0].DefaultValue = MainAsset;
            //txtAssetSub.DataBind();

            //DatasourceAssetSub.SelectCommand = "Select M.MainAccount_SubLedgerType,S.SubAccount_MainAcReferenceID,S.SubAccount_Code from Master_SubAccount S,Master_MainAccount M where S.SubAccount_MainAcReferenceID='" + MainAsset + "' And  M.MainAccount_SubLedgerType='Custom' And S.SubAccount_MainAcReferenceID=M.MainAccount_AccountCode";
            //txtAssetSub.DataBind();
        }
        protected void AssetDetailGrid_CustomCallback(object sender, ASPxGridViewCustomCallbackEventArgs e)
        {

            DataTable dtblMain = null;

            if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {
                AssetDetailDatasource.SelectCommand = "select (MainAccount_Name+'['+MainAccount_AccountCode+']') as MainAccountName,isnull(SUM(Disposals),0.00)as Disposals,isnull(SUM(AssetDetail_Depreciation),0.00) As Depreciation,isnull(SUM(Additions),0.00) As Additions,isnull(Sum(OpeningBalance),0.00)As OpeningBalance,isnull(SUM(AssetDetail_CostPrice),0.00) as CostPrice,(isnull(SUM(OpeningBalance),0.00)+isnull(SUM(Additions),0.00)-isnull(SUM(AssetDetail_Disposals),0.00)-isnull(SUM(AssetDetail_Depreciation),0.00)) as NetValue from (Select *,CASE WHEN AccountsLedger_TransactionType='OpeningBalance'Then isnull(AccountsLedger_AmountDr,0.00) END as OpeningBalance,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AccountsLedger_AmountDr Else 0.00 END as Additions,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AccountsLedger_AmountCr Else 0.00 END as Disposals from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.* From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' Group By MainAccount_Name,MainAccount_AccountCode";
            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {

                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' Group By AccountsLedger_MainAccountID";

            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {

                if (txtAssetSub.Text != "ALL")

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' Group By AccountsLedger_MainAccountID";
                else
                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "'Group By AccountsLedger_MainAccountID";

            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {

                if (txtAssetSub.Text != "ALL")

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' Group By AccountsLedger_MainAccountID";
                else

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' Group By AccountsLedger_MainAccountID";

            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {

                if (txtAssetSub.Text != "ALL")

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";
                else

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";

            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {


                if (txtAssetSub.Text != "ALL")
                {


                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";

                }
                else
                {

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";

                }

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {

                if (txtAssetSub.Text != "ALL")
                {
                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";
                }
                else
                {
                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";

                }

            }

            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {


                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";


            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {

                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {

                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";


            }

            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {
                if (txtAssetSub.Text != "ALL")
                {


                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' Group By AccountsLedger_MainAccountID";

                }
                else
                {

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' Group By AccountsLedger_MainAccountID";

                }
            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {

                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' Group By AccountsLedger_MainAccountID";


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {

                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {

                if (txtAssetSub.Text != "ALL")

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";
                else

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "' Group By AccountsLedger_MainAccountID";

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {

                AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AssetDetail_Location='" + txtLocation_hidden.Text + "' And AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' Group By AccountsLedger_MainAccountID";

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {
                if (txtAssetSub.Text != "ALL")
                {


                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' Group By AccountsLedger_MainAccountID";

                }
                else
                {

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' Group By AccountsLedger_MainAccountID";

                }
            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {
                if (txtAssetSub.Text != "ALL")
                {


                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "'AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' And AssetDetail_SubAccountCode='" + txtAssetSub.Text + "' Group By AccountsLedger_MainAccountID";

                }
                else
                {

                    AssetDetailDatasource.SelectCommand = "select AccountsLedger_MainAccountID as MainAccountCode,SUM(isnull(AssetDetail_Disposals,0.00))as Disposals,SUM(isnull(AssetDetail_Depreciation,0.00)) As Depreciation,SUM(isnull(Additions,0.00)) As Additions,Sum(AccountsLedger_AmountDr)As OpeningBalance,SUM(isnull(AssetDetail_CostPrice,0.00))as CostPrice,(SUM(isnull(AccountsLedger_AmountDr,0.00))+SUM(isnull(Additions,0.00))-SUM(isnull(AssetDetail_Disposals,0.00))-SUM(isnull(AssetDetail_Depreciation,0.00))) as NetValue from(Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then AssetDetail_Additions+AccountsLedger_AmountDr-AccountsLedger_AmountCr Else AssetDetail_Additions END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_User='" + txtUsedBy_hidden.Text + "'AND AssetDetail_MainAccountCode='" + txtAssetMain.Text + "' Group By AccountsLedger_MainAccountID";

                }
            }

            AssetDetailGrid.DataBind();

        }
        protected void AssetDetailGrid_DataSelect(object sender, EventArgs e)
        {
            Session["KeyVal"] = (sender as ASPxGridView).GetMasterRowKeyValue();
            string str = Convert.ToString(Session["KeyVal"]);
            string[] strname = str.Split('[');
            DataTable dtbl1 = null;
            //All All Values
            if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {
                //DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";
                //dtbl1= oDBEngine.GetDataTable("Select MS.SubAccount_Name,T.AccountsLedger_AmountDr,CASE WHEN T.AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountDr END as Additions,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountCr  END as Disposals from Master_SubAccount MS,Master_MainAccount MA,trans_accountsledger T where MA.MainAccount_AccountCode=MS.SubAccount_MainAcReferenceID AND T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode AND T.AccountsLedger_SubAccountID=MS.SubAccount_Code And MA.MainAccount_Name='" + Session["KeyVal"] + "' and T.AccountsLedger_CompanyID='" + Scompany + "' And T.AccountsLedger_FinYear='" + FinYear + "'";
                dtbl1 = oDBEngine.GetDataTable("Master_SubAccount MS,Master_MainAccount MA,trans_accountsledger T", "MS.SubAccount_Name,T.AccountsLedger_AmountDr,CASE WHEN T.AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountDr END as Additions,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountCr  END as Disposals", "MA.MainAccount_AccountCode=MS.SubAccount_MainAcReferenceID AND T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode AND T.AccountsLedger_SubAccountID=MS.SubAccount_Code And MA.MainAccount_Name='" + strname[0] + "' and T.AccountsLedger_CompanyID='" + Scompany + "' And T.AccountsLedger_FinYear='" + FinYear + "'");
                if (dtbl1.Rows.Count > 0)
                {
                    DataSourceDetailAssetGrid.SelectCommand = "Select SubAccountCode,isnull(Sum(OpeningBalance),0.00) as OpeningBalance,isnull(SUM(Disposals),0.00)as Disposals,isnull(SUM(Depreciation),0.00) as Depreciation,isnull(SUM(Additions),0.00) As Additions,isnull(SUM(CostPrice),0.00) As CostPrice,isnull(SUM(OpeningBalance),0.00)+isnull(SUM(Additions),0.00)-isnull(SUM(Disposals),0.00)-isnull(SUM(Depreciation),0.00) as NetValue From (select (MS.SubAccount_Name+'['+MS.SUBACCOUNT_CODE+']') as SubAccountCode,T.AccountsLedger_AmountDr as OpeningBalance,0.00 as Depreciation,0.00 as CostPrice,CASE WHEN T.AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountDr END as Additions,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountCr  END as Disposals,null as NetValue From Master_SubAccount MS,Master_MainAccount MA,trans_accountsledger T where MA.MainAccount_AccountCode=MS.SubAccount_MainAcReferenceID AND T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode AND T.AccountsLedger_SubAccountID=MS.SubAccount_Code AND MA.MainAccount_Name='" + strname[0] + "' and T.AccountsLedger_CompanyID='" + Scompany + "' And T.AccountsLedger_FinYear='" + FinYear + "') as tab1 Group By SubAccountCode";
                }
                else
                {
                    //DataSourceDetailAssetGrid.SelectCommand = "select MS.SubAccount_Name,T.AccountsLedger_AmountDr,CASE WHEN T.AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountDr END as Additions,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then T.AccountsLedger_AmountCr  END as Disposals From Master_SubAccount MS,Master_MainAccount MA,trans_accountsledger T where MA.MainAccount_AccountCode=MS.SubAccount_MainAcReferenceID AND T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode AND T.AccountsLedger_SubAccountID=MS.SubAccount_Code And MA.MainAccount_Name='" + Session["KeyVal"] + "' and T.AccountsLedger_CompanyID='" + Scompany + "' And T.AccountsLedger_FinYear='" + FinYear + "'";

                }

            }
            //cmbAssetCategory not all Others All
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {
                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

            }
            //cmbcmbAssetCategory and txtAssetMain not all and others all
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {
                //check subasset all or not

                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";
                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";
                }


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {

                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";
                }


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {

                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {

                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {

                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";


            }

            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {

                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "'and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text != "ALL")
            {
                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text == "ALL")
            {

                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "'And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }

            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {
                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {
                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";


            }
            else if (cmbAssetCategory.SelectedItem.Text != "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {

                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "' And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Category='" + cmbAssetCategory.SelectedItem.Value + "'and AssetDetail_User='" + txtUsedBy_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text == "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {

                DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "'And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text != "ALL" && txtUsedBy.Text == "ALL")
            {
                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AccountsLedger_FinYear='" + FinYear + "' And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "'And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' And AssetDetail_Location='" + txtLocation_hidden.Text + "' And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
            }
            else if (cmbAssetCategory.SelectedItem.Text == "ALL" && txtAssetMain.Text != "ALL" && txtLocation.Text == "ALL" && txtUsedBy.Text != "ALL")
            {
                if (txtAssetSub.Text != "ALL")
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "'  And AccountsLedger_FinYear='" + FinYear + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "'And AccountsLedger_SubAccountID='" + txtAssetSub.Text + "'And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
                else
                {
                    DataSourceDetailAssetGrid.SelectCommand = "select (cnt_firstName+isnull(cnt_middleName,'')+cnt_lastName) as CustomerName,Additions,AccountsLedger_SubAccountID as SubAccountCode,branch_description as Desciption,AssetDetail_ID,AssetDetail_Location as Location,isnull(AssetDetail_Disposals,0.00) as Disposals,isnull(AssetDetail_Depreciation,0.00) as Depreciation,isnull(AccountsLedger_AmountDr,0.00) as OpeningBalance,isnull(AssetDetail_CostPrice,0.00) as CostPrice,isnull(AccountsLedger_AmountDr,0.00)+isnull(Additions,0.00)-isnull(AssetDetail_Disposals,0.00)-isnull(AssetDetail_Depreciation,0.00) as NetValue from (Select * from trans_accountsledger T,Master_MainAccount MA where T.AccountsLedger_MainAccountID=MA.MainAccount_AccountCode And MA.MainAccount_BankCashType='Fixed Asset') as tab1 left outer join (Select AccountsLedger_ID,Master_AssetDetail.*,CASE WHEN AccountsLedger_TransactionType='Cash_Bank'Then isnull(AssetDetail_Additions,0.00)+isnull(AccountsLedger_AmountDr,0.00)-isnull(AccountsLedger_AmountCr,0.00) Else isnull(AssetDetail_Additions,0.00) END as Additions From Master_AssetDetail,trans_accountsledger where Master_AssetDetail.AssetDetail_CompanyID=trans_accountsledger.AccountsLedger_CompanyID And Master_AssetDetail.AssetDetail_MainAccountCode=trans_accountsledger.AccountsLedger_MainAccountID And Master_AssetDetail.AssetDetail_SubAccountCode=trans_accountsledger.AccountsLedger_SubAccountID And Master_AssetDetail.AssetDetail_FinYear=trans_accountsledger.Accountsledger_FinYear) as tab2 on tab1.AccountsLedger_Id=tab2.AccountsLedger_ID left outer join (Select B.* from tbl_master_contact B,Master_AssetDetail M Where B.cnt_internalid=M.AssetDetail_USER) as tab3 on tab2.AssetDetail_User=tab3.cnt_internalid left outer join (Select Br.* from tbl_master_branch Br,Master_AssetDetail M where Br.branch_id=M.AssetDetail_Location) as tab4 on tab2.AssetDetail_Location=tab4.branch_id where AccountsLedger_CompanyID='" + Scompany + "' And AccountsLedger_FinYear='" + FinYear + "' and AssetDetail_User='" + txtUsedBy_hidden.Text + "'And AccountsLedger_MainAccountID='" + Session["KeyVal"] + "'";

                }
            }


            DataSourceDetailAssetGrid.DataBind();


        }
        protected void txtAssetMain_SelectedIndexChanged(object sender, EventArgs e)
        {

        }
        protected void btnShow_Click(object sender, EventArgs e)
        {

        }
        protected void AssetDetailGrid_CustomJSProperties1(object sender, ASPxGridViewClientJSPropertiesEventArgs e)
        {
            e.Properties["cpheight"] = "error";
        }
        protected void AssetDetailGrid_HtmlRowCreated(object sender, ASPxGridViewTableRowEventArgs e)
        {
            if (e.RowType == GridViewRowType.Data)
            {

                if (e.GetValue("OpeningBalance") != DBNull.Value)
                {
                    e.Row.Cells[2].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("OpeningBalance")));

                }
                if (e.GetValue("Additions") != DBNull.Value)
                {
                    e.Row.Cells[3].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("Additions")));
                }
                if (e.GetValue("Depreciation") != DBNull.Value)
                {
                    e.Row.Cells[4].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("Depreciation")));

                }
                if (e.GetValue("Disposals") != DBNull.Value)
                {
                    e.Row.Cells[5].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("Disposals")));

                }
                if (e.GetValue("NetValue") != DBNull.Value)
                {
                    e.Row.Cells[6].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("NetValue")));

                }
                if (e.GetValue("CostPrice") != DBNull.Value)
                {
                    e.Row.Cells[7].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("CostPrice")));

                }
            }

        }
        protected void AssetDetailGrid_HtmlEditFormCreated(object sender, ASPxGridViewEditFormEventArgs e)
        {

        }
        protected void AssetDetailGrid_RowInserting(object sender, DevExpress.Web.Data.ASPxDataInsertingEventArgs e)
        {

        }
        protected void DetailAssetGrid_HtmlRowCreated(object sender, ASPxGridViewTableRowEventArgs e)
        {
            if (e.RowType == GridViewRowType.Data)
            {

                if (e.GetValue("OpeningBalance") != DBNull.Value)
                {
                    e.Row.Cells[1].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("OpeningBalance")));

                }
                if (e.GetValue("Additions") != DBNull.Value)
                {
                    e.Row.Cells[2].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("Additions")));
                }
                if (e.GetValue("Depreciation") != DBNull.Value)
                {
                    e.Row.Cells[4].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("Depreciation")));

                }
                if (e.GetValue("Disposals") != DBNull.Value)
                {
                    e.Row.Cells[3].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("Disposals")));

                }
                if (e.GetValue("NetValue") != DBNull.Value)
                {
                    e.Row.Cells[6].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("NetValue")));

                }
                if (e.GetValue("CostPrice") != DBNull.Value)
                {
                    e.Row.Cells[5].Text = objConverter.getFormattedvaluewithoriginalsign(Convert.ToDecimal(e.GetValue("CostPrice")));

                }
            }
        }
        protected void AssetDetailGrid_HtmlDataCellPrepared(object sender, ASPxGridViewTableDataCellEventArgs e)
        {

        }
        protected void DetailAssetGrid_HtmlDataCellPrepared(object sender, ASPxGridViewTableDataCellEventArgs e)
        {
            if (e.DataColumn.FieldName == "")
            {
                string kv = e.GetValue("SubAccountCode").ToString();
                string ky = Session["KeyVal"].ToString();
                e.Cell.Style.Value = "cursor:pointer;color: #000099;text-align:left;";
                e.Cell.Attributes.Add("onclick", "OnMoreInfoClick('" + kv + "','" + ky + "')");
            }
        }
    }
}